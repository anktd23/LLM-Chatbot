A stochastic block model for community detection in attributed networks Xiao Wang a, Fang Dai a, *, Wenyan Guo a, Junfeng Wang a a School of Science, Xi’an University of Technology, Xi’an, China E-mail addresses: daifang@xaut.edu.cn (Dai Fang) 2210920031@stu.xaut.edu.cn (Xiao Wang) Abstract—Community detection is an important content in complex network analysis. The existing community detection methods in attributed networks mostly focus on only using network structure, while the methods of integrating node attributes is mainly for the traditional community structures, and cannot detect multipartite structures and mixture structures in network. In addition, the model-based community detection methods currently proposed for attributed networks do not fully consider unique topology information of nodes, such as betweenness centrality and clustering coefficient. Therefore, a stochastic block model that integrates betweenness centrality and clustering coefficient of nodes for community detection in attributed networks, named BCSBM, is proposed in this paper. Different from other generative models for attributed networks, the generation process of links and attributes of nodes in BCSBM model follows the Poisson distribution, and the probability between community is considered based on the stochastic block model. Moreover, the betweenness centrality and clustering coefficient of nodes are introduced into the process of links and attributes of nodes generation. Finally, the expectation maximization algorithm is employed to estimate the parameters of the BCSBM model, and the node-community memberships in network is obtained through the hard division process, so the community detection is completed. By experimenting on six real-work networks containing different network structures, and comparing with the community detection results of five algorithms, the experimental results show that the BCSBM model not only inherits the advantages of the stochastic block model and can detect various network structures, but also has good data fitting ability due to introducing the betweenness centrality and clustering coefficient of nodes. Overall, the performance of this model is superior to other five compared algorithms. Keyworks stochastic block model; attributed network; community detection; betweenness centrality; clustering coefficient1. Introduction An attributed network refers to a network in which the nodes or edges contain attribute information. [1].Unlike non-attributed networks that only consider the links between nodes, attributed network can model the characteristics or attributes of nodes in complex systems and provide much richer and heterogeneous information [2]. For example, in social networks, attributes can provide information about individuals' age, gender, interests, occupation, and location. In academic citation networks, attributes contain important information such as titles, authors, abstract, keywords, etc. Therefore, the studying of attributed networks is very significant to the theoretical research and application of complex systems in the real world. Recently, the community detection in attributed networks has attracted widespread attention from researchers. Zhou et al. [4] proposed the SA-Cluster algorithm, which uses a unified distance measure to combine topology structures and attributes to construct a weighted network, and employed a clustering algorithm based on K- Medoids [5] to mine the community structure in the weighted network. This algorithms is similarity-based for community detection in attributed networks, the relevant algorithms are SAGL [6], PWMN [7], ANCA [8] and SAS-LP [9]. In addition, Wang et al. [10] proposed the SCI algorithm, which uses a two-factor non-matrix factorization method to extract the node memberships matrix from the attribute matrix and adjacency matrix to achieve community detection. The algorithm is based on non-negative matrix factorization for community detection in attributed networks, the related algorithms are PICS [11], SCD [12], MDNMF [13] and TENE [14]. These above algorithms are widely applied to detect communities with assortative structures shown as Fig. 1(a), i.e., tight intra-community node links and relatively sparse inter-community node links [15]. However, in the real world, there are not only assortative structures but also disassortative structures [16], such as multipartite structures shown as Fig. 1(b) (node links within communities are sparse, and node links between communities are reversely densely), and mixture structures such as Fig. 1(c) (It contains both community structure and multipartite structures). Currently, the main approach that can deal with both assortative networks and disassortative networks is stochastic block model (SBM) [18]. The SBM is a common model for characterizing networks with complex structural patterns, such as community, multipartite and mixture structures. Chai et al.[19] inherited the advantages of general stochastic block model (GSB) [20] and popularity and productivity link model (PPL) [21], introduced the popularity and productivity of nodes to simulate the scale-free properties of real networks and proposed PPSB_DC model. A two-stage projection algorithm is used to estimate model parameters for PPSB_DC, but a recent study found [22]: this two-stage algorithm does not guarantee convergence. Chen et al. [23] proposed BNPA model based on Newman's mixture models (NMM) [24] and Bayesian nonparametric theory. This model not only makes full use of the links between nodes and attributes of nodes to divide communities by sharing hidden variables, but also employs Bayesian nonparametric theory to determine the number of communities automatically, whichFig.1 Examples of assortative and disassortative networks [17] (a) assortative network with community structures; (b) disassortative network with multipartite structures; (c) disassortative network with mixture structures solves the problem of other methods that need to define the number of communities in advance, but it may be inaccurate to infer the number of communities, which will affect the accuracy of community detection. He et al. [25] proposed NEMBP model, which combines degree-corrected stochastic block model (DSBM) [26] and multinomial distributions to model the generation process of links and attributes to better fit the real network. The model parameters are inferred by using the nested Expectation-Maximum (EM) algorithm [27] and belief propagation (BP) [28]. Compared to the EM algorithm alone, the solution complexity of the NEMBP model is higher. Chen et al. [29] proposed subspace stochastic block model (SSB), which not only incorporates the attributes of nodes into the GSB model in the form of probabilities, but also constructs a hidden network by integrating the topology information and attribute information in the process of generating links between nodes. In this hidden network, it is possible to generate links between all nodes, avoiding the consideration of unobserved edges, thus avoiding the negative sampling strategy. Chang et al. [22] proposed PSB_PG model, which constructs a generative model based on the potential relationship between links and attributes of nodes. However, since real networks have scale-free property, the degree of nodes follows power-law distribution, Zheng et al. [30] introduced the degree of nodes on the basis of PSB_PG and proposed the degree-corrected stochastic block model for attributed networks (DPSB_PG). However, these two models do not fully consider the unique topological information of nodes, such as betweenness centrality and clustering coefficient, etc. According to the assumption of consistency between node attributes and topology structure, it can be seen that topological information of nodes often has a great correlation with the topology structures and can affect the links between nodes. Based on the DPSB_PG, an attributed network stochastic block model BCSBM that integrates betweenness centrality and clustering coefficient of nodes is presented in this paper, which comprehensively considers the importance of nodes and the property of node neighborhood structure. The betweenness centrality characterizes the importance of nodes by the number of shortest paths passing through a node and also describes the influence of nodes on the flow of information on the network. The clustering coefficient describes the likelihood that neighboring nodes of individuals inthe network are also neighbors of each other and is used to measure the extent of node clustering. In the BCSBM, the generation of network structures and node attributes follow the Poisson distribution and are independent of each other. It is worth noting that the BCSBM model in this paper is an extension of the DPSB_PG model, and its main difference is that the two observation variables of betweenness centrality and clustering coefficient of nodes are introduced, and the performance of the model is analyzed during the experiments. The paper is organized as follows. In Section 2, we introduce the BCSBM model. In Section 3, the parameters estimation of the BCSBM model by the EM algorithm is described. The process of community detection based on the BCSBM model is presented in Section 4. In Section 5, we give the analysis of the community detection results. Finally, we conclude our work and discuss future in Section 6. 2. BCSBM Model Let 𝐷���(𝑉, 𝐷���, 𝑉���) denotes an undirected and unweighted attributed network, where 𝑉 = {1, 2, ⋯ , 𝑖���} denotes the set of 𝑖��� nodes in the network and 𝐷��� = {𝑎���1, 𝑎���2, ⋯ , 𝑎���𝑖���} denotes the set of 𝑖��� edges in the network. If the attribute of each node is denoted by a 𝐾 dimension vector, the attribute matrix of all nodes can be expressed as 𝑉��� = (𝑥𝑖𝑖���)𝑖���×𝐾, where 𝑥𝑖𝑖��� = 1 denotes node 𝑖 has 𝑖��� th attribute, otherwise 𝑥𝑖𝑖��� = 0 . Typically, the adjacency matrix of an undirected unweighted network is denoted by 𝐴 = (𝑎𝑖𝑖���)𝑖���×𝑖��� , where 𝑎𝑖𝑖��� = 1 denotes node 𝑖 links to node 𝑖��� , otherwise 𝑎𝑖𝑖��� = 0. Suppose a network 𝐷��� has 𝑎��� different communities 𝑉1, 𝑉2, ⋯ , 𝑉𝑟 and 𝑉 = ⋃ 𝑉𝑟 𝑎��� 𝑟=1 . 2.1 A generative model for integrating node topology information In a standard stochastic block model [18], the stochastic block probability matrix Θ = (𝜃𝑟𝑟���)𝑎���×𝑎��� controls the probability of generating links in network, where 𝜃𝑟𝑟��� is the connecting probability of two nodes 𝑖 ∈ 𝑉𝑟 and 𝑖��� ∈ 𝑉𝑟��� and is only related to the communities to which 𝑖 and 𝑖��� belong. In the PSB_PG model [22], Chang et al. relaxed this restriction by introducing a node-community memberships matrix 𝐷 = (𝑎���𝑖𝑟)𝑖���×𝑎���, where 𝑎���𝑖𝑟 is the probability that a node 𝑖 belongs to the 𝑞���th community 𝑉𝑟. In the DPSB_PG model [30], Zheng et al. introduced the degree of nodes into the PSB_PG model to influence the generation of network links. In the BCSBM model of this paper, the generation of links in network is strengthened by introducing betweenness centrality and clustering coefficient of nodes to affect the distribution of community. A link between pair of nodes in network is not only related to the node-community memberships matrix 𝐷, the inter-community probability matrix Θ and the degree of nodes Γ = (𝑖���𝑖)𝑖���×1 , but also affected by the betweenness centrality of nodes Β = (𝑎���𝑖)𝑖���×1 and clustering coefficient of nodes Μ = (𝑎���𝑖)𝑖���×1 . So, we introduce betweenness centrality and clustering coefficient of nodes to control the network generation process, the real network can be better fitted. Assuming that the generation of links between pairs of nodes (𝑥, 𝑥���) is independent and follows the Poisson distribution, the expected number of links that nodes 𝑖 and node 𝑖��� lies incommunities 𝑉𝑟 and 𝑉𝑟��� is 𝑖���̂𝑖𝑖��� 𝑟𝑟��� = 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� where 𝛾���𝑖 = 𝑖���𝑖 + 𝑎���𝑖 + 𝑎���𝑖 , 𝑎���𝑖 = 2𝑖���𝑖 𝑖���𝑖(𝑖���𝑖−1) is the clustering coefficient of node 𝑖 [31] , 𝑎���𝑖 = ∑ 𝑖���𝑟���𝑟��� 𝑖 𝑟���,𝑟���≠𝑖 𝑔𝑟���𝑟��� is the betweenness centrality of node 𝑖 [32], 𝑖���𝑖 is the degree of node 𝑖, 𝑖���𝑖 is the total real links number of node 𝑖’s neighbors, 𝑔𝑟���𝑟��� is the number of shortest paths between nodes 𝑞��� and 𝑞���, 𝑖���𝑟���𝑟��� 𝑖 is the number of those shortest paths that include node 𝑖. Considering all communities, the expected total number of links between nodes 𝑖 and 𝑖��� is 𝑖���̂𝑖𝑖��� = ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑎��� 𝑟,𝑟���=1 where Θ is symmetrical, ∑ 𝛾���𝑖𝑎���𝑖𝑟 𝑖��� 𝑖=1 =1 and ∑ 𝜃𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 = 1 satisfy the normalization constraints. Suppose the generation of links is independent and the number of links follows the Poisson distribution with mean value 𝑖���̂𝑖𝑖���, given the parameters 𝐷, Θ and observed variables 𝑅���, the probability of generating a network is 𝑃(𝐴|𝐷, Θ, 𝑅���) = ∏ (∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑎��� 𝑟,𝑟���=1 ) 𝑎𝑖𝑖��� 𝑎𝑖𝑖���! exp (− ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑎��� 𝑟,𝑟���=1 ) 𝑖��� 𝑖,𝑖���=1,𝑖<𝑖��� × ∏ (1 2 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟𝛾���𝑖𝑎���𝑖𝑟)𝑎𝑖𝑖/2 (𝑎𝑖𝑖/2)! 𝑖��� 𝑖=1 exp (− 1 2 ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟𝛾���𝑖𝑎���𝑖𝑟 𝑎��� 𝑟=1 ) (1) where 𝑅��� = ⋃ {𝑖���𝑖, 𝑎���𝑖, 𝑎���𝑖} 𝑖��� 𝑖=1 is the set of degree 𝑖���𝑖 , clustering coefficient 𝑎���𝑖 and betweenness centrality 𝑎���𝑖 of the nodes. 2.2 A generative model for integrating node attribute information Generally, the attributes corresponding to each node in attributed networks are high-dimensional, and whether the nodes in the community have common attributes is sparse. If the attributes of nodes in a community are highly correlated, they will also be consistent or complementary to the network topology structures, promoting the formation of community. Therefore, the generation of node attributes follows the Poisson distribution according to Poisson’ theorem [39]. Let 𝜙𝑟𝑖��� denote the probability that a community 𝑉𝑟 has the 𝑖��� th attribute, and Φ = (𝜙𝑟𝑖���)𝑎���×𝐾 denote community-related attributes matrix. Similarly, nodes 𝑖 in the community 𝑉𝑟 possessing 𝑖��� th attribute related to degree 𝑖���𝑖 , betweenness centrality 𝑎���𝑖 , clustering coefficient 𝑎���𝑖 , node-community memberships 𝑎���𝑖𝑟 and community-related attributes 𝜙𝑟𝑖���. And for this reason, the propensity of node 𝑖 in the community 𝑉𝑟 possessing the 𝑖���th attribute is 𝑉���̂𝑖𝑖��� 𝑟 = 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖���Summing over all communities 𝑉𝑟, the mean propensity of node 𝑖 possessing the 𝑖���th attribute is 𝑉���̂𝑖𝑖��� = ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝑎��� 𝑟=1 where ∑ 𝑎���𝑖𝑟 𝑖��� 𝑖=1 = 1 and ∑ 𝜙𝑟𝑖��� = 1 𝐾 𝑖���=1 satisfy the normalization constraints. According to the Poisson distribution process, given the parameter matrix 𝐷, Φ and the observed variables 𝑅��� = ⋃ {𝑖���𝑖, 𝑎���𝑖, 𝑎���𝑖} 𝑖��� 𝑖=1 , the probability 𝑃(𝑉���|𝐷, Θ, 𝑅���) of generating node attributes in network is 𝑃(𝑉���|𝐷, Θ, 𝑅���) = ∏ ∏ (∑ 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝑎��� 𝑟=1 )𝑥𝑖𝑖��� 𝑥𝑖𝑖���! exp (− ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝑎��� 𝑟=1 ) 𝐾 𝑖���=1 𝑖��� 𝑖=1 (2) 2.3 Integrating node topology and attribute information Assuming that the generative process of the adjacency matrix 𝐴 and attribute matrix 𝑉��� in network are independent of each other, the joint probability is 𝑃(𝐴, 𝑉���|𝐷, Θ, Φ, 𝑅���) = 𝑃(𝐴|𝐷, Θ, 𝑅���) × 𝑃(𝑉���|𝐷, Φ, 𝑅���) = ∏ (∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑎��� 𝑟,𝑟���=1 ) 𝑎𝑖𝑖��� 𝑎𝑖𝑖���! exp 𝑖��� 𝑖,𝑖���=1,𝑖<𝑖��� (− ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑎��� 𝑟,𝑟���=1 ) × ∏ (1 2 ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟𝛾���𝑖𝑎���𝑖𝑟 𝑎��� 𝑟=1 ) 𝑎𝑖𝑖 2 (𝑎𝑖𝑖 2 ) ! exp (− 1 2 ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟𝛾���𝑖𝑎���𝑖𝑟 𝑎��� 𝑟=1 ) 𝑖��� 𝑖=1 × ∏ ∏ (∑ 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝑎��� 𝑟=1 )𝑥𝑖𝑖��� 𝑥𝑖𝑖���! exp (− ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖���) 𝑎��� 𝑟=1 ) 𝐾 𝑖���=1 𝑖��� 𝑖=1 (3) The generative process of integrating topology information and attribute information of nodes in network can be summarized as follows. 1) Extracting nodes 𝑖 and 𝑖��� from the communities 𝑉𝑟 and 𝑉𝑟��� with probability 𝑎���𝑖𝑟 and 𝑎���𝑖���𝑟���, respectively. 2) Forming a link between node 𝑖 and node 𝑖��� with probability 𝑖���𝑖𝑖��� , where 𝑖���𝑖𝑖���~𝑃𝑖���𝑖𝑞���𝑞���𝑖���𝑖���(𝑖���̂𝑖𝑖���). 3) Selecting an attribute 𝑖��� in the community 𝑉𝑟 with probability 𝜙𝑟𝑖���. 4) Selecting an attribute 𝑖��� for the node 𝑖 with probability 𝑉���𝑖𝑖��� , where 𝑉���𝑖𝑖���~𝑃𝑖���𝑖𝑞���𝑞���𝑖���𝑖���(𝑉���̂𝑖𝑖���). The corresponding probabilistic graph model is shown in Fig 2.Fig.2 The probabilistic graph model for BCSBM Fig.2 The probabilistic graph model for BCSBM 3. Estimating parameters of BCSBM model using the EM algorithm The model BCSBM contains observed variables 𝐴, 𝑉���, 𝑅���, hidden variables Q = (𝑞𝑖𝑖��� 𝑟𝑟���)𝑖���×𝑖��� ,Υ = ( 𝛾𝑖𝑖��� 𝑟 )𝑖���×𝑎��� , and model parameters 𝐷 = (𝑎���𝑖𝑟)𝑖���×𝑎��� , Θ = (𝜃𝑟𝑟���)𝑎���×𝑎��� , Φ = (𝜙𝑟𝑖���)𝑎���×K. Due to the existence of hidden variables in the model, the likelihood function cannot be solved directly, and the EM algorithm [27] is the most common hidden variable estimation method, which can handle such problems well. Therefore, in this paper, the EM algorithm is employed to estimate the parameters of the BCSBM model. The inference process is as follows. Considering the logarithm of the Eq. (3), neglecting the constants and terms independent of model parameters, we have 𝐾���(𝐷, Θ, Φ) = ∑ [1 2 𝑎𝑖𝑖��� ln ( ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑎��� 𝑟,𝑟���=1 ) − 1 2 ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑎��� 𝑟,𝑟���=1 ] 𝑖��� 𝑖,𝑖���=1 + ∑ ∑ ∑ [𝑥𝑖𝑖��� ln (∑ 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝑎��� 𝑟=1 ) − ∑ 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝑎��� 𝑟=1 ] 𝑎��� 𝑟=1 𝐾 𝑖���=1 𝑖��� 𝑖=1 (4) In E-step, given the parameters 𝐷, Θ and Φ , and the lower bound of the log- likelihood obtained by Jensen's inequality is 𝐾���̅(𝐷, Θ, Φ) = 1 2 ∑ ∑ [𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� ln (𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑞𝑖𝑖��� 𝑟𝑟��� ) − 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟���] 𝑎��� 𝑟,𝑟���=1 𝑖��� 𝑖,𝑖���=1 + ∑ ∑ ∑ [𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 ln (𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝛾𝑖𝑖��� 𝑟 ) − 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖���] 𝑎��� 𝑟=1 𝐾 𝑖���=1 𝑖��� 𝑖=1 (5) where𝑞𝑖𝑖��� 𝑟𝑟��� = (𝑖���𝑖 + 𝑎���𝑖 + 𝑎���𝑖)𝑎���𝑖𝑟𝜃𝑟𝑟���(𝑖���𝑖��� + 𝑎���𝑖��� + 𝑎���𝑖���)𝑎���𝑖���𝑟��� ∑ (𝑖���𝑖 + 𝑎���𝑖 + 𝑎���𝑖)𝑎���𝑖𝑟𝜃𝑟𝑟���(𝑖���𝑖��� + 𝑎���𝑖��� + 𝑎���𝑖���)𝑎���𝑖���𝑟��� 𝑎��� 𝑟,𝑟���=1 (6) 𝛾𝑖𝑖��� 𝑟 = (𝑖���𝑖 + 𝑎���𝑖 + 𝑎���𝑖)𝑎���𝑖𝑟𝜙𝑟𝑖��� ∑ (𝑖���𝑖 + 𝑎���𝑖 + 𝑎���𝑖)𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝑎��� 𝑟=1 (7) 𝑞𝑖𝑖��� 𝑟𝑟��� denotes the probability that nodes 𝑖 and 𝑖��� lie in communities 𝑉𝑟 and 𝑉𝑟��� , respectively, and there is a link between nodes 𝑖 and 𝑖���; 𝛾𝑖𝑖��� 𝑟 denotes the probability that node 𝑖 in the community 𝑉𝑟 and has the 𝑖���th attribute. In M-step, given the hidden variables 𝑞𝑖𝑖��� 𝑟𝑟��� and 𝛾𝑖𝑖��� 𝑟 , and we can obtain the three parameter estimates 𝑎���𝑖𝑟, 𝜃𝑟𝑟���, 𝜙𝑟𝑖��� according to the Lagrange multiplier method as follows 𝑎���𝑖𝑟 = ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� + 2 × ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑎��� 𝑟���=1 𝑖��� 𝑖���=1 (𝑖���𝑖 + 𝑎���𝑖 + 𝑎���𝑖) × [∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� + 2 × ∑ ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑖��� 𝑖=1 𝑎��� 𝑟���=1 𝑖��� 𝑖,𝑖���=1 ] (8) 𝜃𝑟𝑟��� = ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑖��� 𝑖,𝑖���=1 ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 𝑖��� 𝑖,𝑖���=1 𝜙𝑟𝑖��� = ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝑖��� 𝑖=1 ∑ ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑖��� 𝑖=1 (9) The derivation of the parameters 𝑎���𝑖𝑟, 𝜃𝑟𝑟���, 𝜙𝑟𝑖��� can be found in Appendix A. The specific steps of the parameter estimation are shown in Algorithm 1. Algorithm 1 Parameter Inference Algorithm for BCSBM Input: the adjacency matrix 𝐴, the attribute matrix 𝑉���, the number of communities 𝑎���, the maximum iteration 𝐼𝑇 and the threshold 𝜕���. Output: the model parameters 𝐷, Θ, Φ 1: According to the adjacency matrix 𝐴, calculate the degree of node 𝑖���𝑖, betweenness centrality of node 𝑎���𝑖 , and clustering coefficient of node 𝑎���𝑖, 𝑖 = 1,2, ⋯ , 𝑖���. 2: Initialize 𝐷(0), Θ(0), Φ(0). 3: Compute the objective function 𝐾���(0) = (𝐷(0), Θ(0), Φ(0)) by Eq. (4). 4: for 𝑞��� = 1:𝐼𝑇 do 5: E-step: Compute 𝑞𝑖𝑖��� 𝑟𝑟���, 𝛾𝑖𝑖��� 𝑟 by Eq. (6) ~ (7). 𝑖, 𝑖��� = 1,2, ⋯ , 𝑖���; 𝑞���, 𝑞��� = 1,2, ⋯ , 𝑎���. 6: M-step: Compute 𝐷(𝑟���), Θ(𝑟���), Φ(𝑟���) by Eq. (8) ~ (9). 7: Compute the objective function 𝐾���(𝑟���) = (𝐷(𝑟���), Θ(𝑟���), Φ(𝑟���)) by Eq. (4). 8: if |𝐾���(𝑟���)(𝐷(𝑟���), Θ(𝑟���), Φ(𝑟���)) − 𝐾���(𝑟���−1)(𝐷(𝑟���−1), Θ(𝑟���−1), Φ(𝑟���−1))| < 𝜕��� or 𝑞��� = 𝐼𝑇 then 9: 𝐷 = 𝐷(𝑟���), Θ = Θ(𝑟���), Φ = Φ(𝑟���); STOP 10: end if 11: end forInitialized scheme of 𝚯 . In the algorithm BCSBM, the initialization of the probability matrix Θ has a great influence on the convergence speed of the algorithm. When the network structure generated by the initialization of the stochastic block probability matrix Θ is consistent with the real network structure, the algorithm will converge quickly. However, when the initial network structure (i.e., the initial values of Θ ) is inconsistent with the real network structure, the algorithm will converge very slowly. For the algorithm to achieve stability with as few iterations as possible, we apply maximum entropy distribution [33] and maximum likelihood to make appropriate choices for the stochastic block probability matrix Θ . The specific approach is as follows [22]. The initialization of the stochastic block probability matrix Θ is divided into three schemes: (1) when the diagonal elements are larger than the non-diagonal elements, it corresponds to the assortative structures in network; (2) when the diagonal elements are smaller than the non-diagonal elements, it corresponds to disassortative structures in network; and (3) when the elements in Θ are floating around a certain value (e.g., 0.5), it corresponds to the other structures in network. The BCSBM algorithm is executed a number of times (e.g., 10 times) for each of these three cases, and then the average of the maximum likelihoods is calculated for each scheme. The initialization form of Θ corresponding to the scheme with the largest average is used as the initialization of the BCSBM algorithm. The time complexity of BCSBM algorithm mainly depends on E-step and M-step of the EM algorithm for parameters estimation. In each iteration process, the time complexity of E-step is Ο(𝑖���𝑎���2 + 𝑖���𝐾𝑎���), and the time complexity of M-step is Ο(𝑖���𝑎��� + 𝑎���2 + 𝑖���𝐾𝑎���). Since the number of communities 𝑎��� is much smaller than the number of nodes 𝑖��� , i.e., 𝑎��� ≪ 𝑖��� . Therefore, the time complexity of M-step can be written as Ο(𝑖���𝐾𝑎���) , and due to the maximum number of iterations of the algorithm is 𝐼𝑇 , the overall time complexity of the algorithm is Ο(𝐼𝑇(𝑖���𝑎���2 + 𝑖���𝐾𝑎���)). 4. Community detection based on BCSBM model Since the node-community memberships matrix 𝐷 characterizes the distribution of each node over all communities, our main goal is to infer the node-community memberships matrix 𝐷 = (𝑎���𝑖𝑟)𝑖���×𝑎��� , i.e., the probability that a node belongs to any community 𝑉𝑟(𝑞��� = 1, 2, ⋯ , 𝑎���). We infer the node-community memberships in network by hard division, that is, using 𝑎���∗ = argmax 𝑟 {𝑎���𝑖𝑟} to limit that a node can only belong to a community. Since hidden variables are introduced when the model parameters are inferred by the EM algorithm, 𝐷 = (𝑎���𝑖𝑟)𝑖���×𝑎��� cannot be processed directly. In order to get the hard partition, we set an operation on the parameter 𝐷 = (𝑎���𝑖𝑟)𝑖���×𝑎���, Θ = (𝜃𝑟𝑟���)𝑎���×𝑎���, that is 𝐼𝑖𝑟 = ∑ 𝜃𝑟𝑟���𝑎���𝑖𝑟 𝑎��� 𝑟���=1 ∑ 𝜃𝑟𝑟���𝑎���𝑖𝑟 𝑎��� 𝑟,𝑟���=1 (10) The BCSBM algorithm can use 𝑞���∗ = argmax 𝑟 {𝐼𝑖𝑟} to find which community the nodeultimately belongs to. 5. Experimental results and analysis 5.1 Datasets In this paper, six real-world attributed networks are selected to examine the community detection performance of BCSBM model, including WebKB (Cornell, Texas, Washington, Wisconsin), Cora and Citeceer. The basic characteristics of the attributed networks are shown in Table 1, where 𝑖��� and 𝑖��� are the number of nodes and links, respectively; 𝐾 is the attribute type; and 𝑎��� is the number of communities. Table 1 Features of the attributed Networks Datasets n m K c Structure WebKB Cornell 195 304 1703 5 disassortative Texas 187 328 1703 5 disassortative Washington 230 446 1703 5 disassortative Wisconsin 265 530 1703 5 disassortative Cora — 2708 5429 1433 7 assortative Citeseer — 3312 4723 3703 6 assortative 1) WebKB dataset [34] is a citation network consisting of web pages and links between web pages of four American universities, Cornell, Texas, Washington, and Wisconsin, with a total of 877 nodes representing all web pages, and 1,608 links representing hyperlinks between web pages. Web pages (i.e., nodes) in network are classified into the following five types, i.e., course, faculty, student, project, and staff. Each node consists of a 1703-dimensional attribute vector. 2) Cora dataset [35] is a citation network of scientific and technical literature with 2708 nodes representing all scientific publications. 5429 links representing the citation relationships from a publication to another. All the scientific publications (i.e., nodes) in network are classified into the following seven types, i.e., case-based reasoning, genetic algorithms, neural networks, probabilistic methods, reinforcement learning, rule learning, and theory. Each node consists of a 1433- dimensional attribute vector. 3) Citeseer dataset [36] is an academic citation network containing 3312 nodes representing all academic papers. 4723 links representing citation relationships between papers. All papers (i.e., nodes) in network are classified into the following six types, i.e., agents, artificial intelligence, databases, human-computer interaction, information retrieval, and machine learning. Each node consists of a 3703- dimensional attribute vector. 5.2 Evaluation criteria To evaluate the community detection performance of BCSBM model on the realnetworks, two evaluation indexes, Normalized Mutual Information (NMI) and Pairwise F-measure (PWF), are adopted in this paper. (1) 𝐾���𝐾���𝐼 The 𝐾���𝐾���𝐼 proposed in [37] is based on the confusion matrix to judge the completeness of information retention after community division. Its definition is shown in Eq. (11). 𝐾���𝐾���𝐼(𝐴, 𝐴���) = −2 ∑ ∑ 𝐾���𝑟𝑟���log (𝐾���𝑟𝑟���𝐾��� 𝐾���𝑟𝐾���𝑟���) 𝑎���2 𝑟���=1 𝑎���1 𝑟=1 ∑ 𝐾���𝑟 𝑎���1 𝑟=1 log (𝐾���𝑟 𝐾��� ) + ∑ 𝐾���𝑟��� 𝑎���2 𝑟���=1 log (𝐾���𝑟��� 𝐾��� ) (11) Where 𝐴 is real community, 𝐴��� is the community divided by the community detection algorithm, 𝑎���1 denotes the number of real community 𝐴, 𝑎���2 denotes the number of community 𝐴��� divided by the community detection algorithm, 𝐾��� is the total number of nodes in network 𝐷���, 𝐾���𝑟, 𝐾���𝑟��� denote the number of nodes in communities 𝑞��� and 𝑞��� respectively, 𝐾���𝑟𝑟��� denotes the number of nodes that should belong to community 𝑞��� but are wrongly assigned to community 𝑞���. The range of 𝐾���𝐾���𝐼 is [0,1] , the larger the value of 𝐾���𝐾���𝐼 is, the better the community detection performance. If 𝐴 = 𝐴���, 𝐾���𝐾���𝐼(𝐴, 𝐴���) = 1 . If 𝐴 and 𝐴��� are completely different, 𝐾���𝐾���𝐼(𝐴, 𝐴���) = 0. (2) 𝑃𝑉���𝐷��� The 𝑃𝑉���𝐷��� proposed in [38] integrates the concepts of precision and recall into a single evaluation, and its definition is shown in Eq. (12). 𝑃𝑉���𝐷��� = 2 × 𝑃𝑞���𝑎���𝑎���𝑖𝑞���𝑖𝑖���𝑖��� × 𝑅𝑎���𝑎���𝑎𝑖���𝑖��� 𝑃𝑞���𝑎���𝑎���𝑖𝑞���𝑖𝑖���𝑖��� × 𝑅𝑎���𝑎���𝑎𝑖���𝑖��� (12) where 𝑃𝑞���𝑎���𝑎���𝑖𝑞���𝑖𝑖���𝑖��� = |𝑅��� ∩ 𝑅���|/|𝑅���| , 𝑅𝑎���𝑎���𝑎𝑖���𝑖��� = |𝑅��� ∩ 𝑅���|/|𝑅���| denote the precision and recall of the division results of the community detection algorithm, respectively, 𝑅��� denotes the set of nodes that are assigned to the same community, 𝑅��� denotes the set of nodes that have the same label, and | ∙ | denotes the number of elements in the set. The range of values of 𝑃𝑉���𝐷��� is also [0,1] . The larger the value of 𝑃𝑉���𝐷��� is, the better the partitioning effect of community algorithm division. 5.3 Experimental results and analysis To verify the validity of the BCSBM model, in this section, experiments are conducted on the six real-world attributed networks shown in Table 1 and compared with the existing generative models that integrate links and attributes of nodes, PPSB_DC [19], BNPA [23], NEMBP [25], PSB_PG [22], and DPSB_PG [30]. In order to maintain fairness, all algorithms keep the optimal parameter settings mentioned in the original paper, and the experimental results are shown in Table 2 and Table 3, Fig.3 and Fig.4. Table 2 and Fig.3 show the 𝐾���𝐾���𝐼 metrics of the six algorithms, and Table 3 and Fig.4 show the 𝑃𝑉���𝐷��� metrics of the six algorithms. Since the EM algorithm is particularly sensitive to initial values, we conducted 30 experiments on each model, and the mean and maximum values of 30 times are given for two indicators.Table 2 𝐾���𝐾���𝐼 of the BCSBM model and compared algorithms on attributed networks Datasets NMI Model Value PPSB_DC BNPA NEMBP PSB_PG DPSB_PG BCSBM Cornell mean 0.1128 0.0772 0.1510 0.3131 0.3246 0.3550 max 0.2503 0.0933 0.2793 0.3973 0.4460 0.4555 Texas mean 0.2085 0.2265 0.2965 0.2882 0.2926 0.3214 max 0.3663 0.2694 0.4202 0.3750 0.3933 0.4636 Washington mean 0.1726 0.2469 0.1938 0.3235 0.3222 0.3617 max 0.3690 0.2701 0.3107 0.3631 0.3437 0.4106 Wisconsin mean 0.1315 0.3212 0.2322 0.3736 0.3772 0.4219 max 0.2409 0.3413 0.4075 0.4230 0.4436 0.4787 Cora mean 0.1820 0.4391 0.4033 0.3012 0.3143 0.3360 max 0.5221 0.5022 0.4757 0.3699 0.3488 0.3593 Citeseer mean 0.1335 0.1700 0.2003 0.2507 0.2646 0.3045 max 0.3805 0.3196 0.2911 0.3318 0.3246 0.3862 Table 3 𝑃𝑉���𝐷��� of the BCSBM model and compared algorithms on attributed networks Datasets PWF Model Value PPSB_DC BNPA NEMBP PSB_PG DPSB_PG BCSBM Cornell mean 0.3789 0.3446 0.3646 0.4378 0.4498 0.4882 max 0.5025 0.3528 0.4722 0.5672 0.6179 0.6637 Texas mean 0.5610 0.5084 0.5622 0.4117 0.4250 0.4852 max 0.6753 0.5257 0.7002 0.5028 0.5408 0.5854 Washington mean 0.4751 0.3851 0.4034 0.4879 0.4829 0.5233 max 0.6118 0.3921 0.6064 0.5483 0.5123 0.6175 Wisconsin mean 0.3900 0.4818 0.3867 0.5290 0.5294 0.5916 max 0.4839 0.4967 0.5484 0.5880 0.5953 0.6501 Cora mean 0.2835 0.4809 0.4337 0.3554 0.3621 0.3846 max 0.3592 0.5423 0.5203 0.4228 0.3891 0.4073 Citeseer mean 0.2733 0.3548 0.3236 0.3561 0.3642 0.4014 max 0.4768 0.3984 0.3804 0.4323 0.3977 0.4318 Note 1: The red bolded values in Table 2 and Table 3 indicate the best, and the black bolded values indicate the next best of the six models. Note 2: The first 3 columns of data are from the literature [30].Fig.3 𝐾���𝐾���𝐼 of the six algorithms on attributed networks Fig.4 𝑃𝑉���𝐷��� of the six algorithms on attributed networks From the above experimental results, it can be seen that the BCSBM model proposed in this paper is suitable for a variety of network structures detection, and the detection effect is significantly improved in the real attribute networks (Cornell, Texas, Washington, Wisconsin) containing disassortative structures. Compared with the PSB_PG model without considering the degree of nodes, the DPSB_PG model has improved the detection effect on attributed networks Cornell, Texas, and Wisconsin, Cornell Texas Washington Wisconsin Cora Citeseer 0.0 0.1 0.2 0.3 0.4 0.5 NMI Datasets PPSB_DC BNPA NEMBP PSB_PG DPSB_PG BCSBM Cornell Texas Washington Wisconsin Cora Citeseer 0.0 0.1 0.2 0.3 0.4 0.5 0.6 PWF Datasets PPSB_DC BNPA NEMBP PSB_PG DPSB_PG BCSBMbut the performance on the Washington is slightly worse. However, the BCSBM model proposed in this paper takes into account the betweenness centrality and clustering coefficient of nodes at the same time, and performs best on the four real attribute networks with disassortative structures. The experiments show that the integration betweenness centrality and clustering coefficient of nodes have a positive impact on the community detection for attributed networks. The BNPA model performs best on the attributed network Cora containing assortative structure, this is due to the fact that it introduces a priori information, which needs to adjust priori parameters, and its detection precision depends on the accuracy of the number of communities estimated, which does not perform well in other networks. The model BCSBM proposed in this paper performs best on the attributed network Citeseer with assortative structure, which indicates that the BCSBM model has good performance in attributed networks containing disassortative and assortative structures. In summary, the comprehensive performance of the BCSBM model proposed in this paper is better than the other five related algorithms, and the experiments show that the stochastic block model integrating betweenness centrality and clustering coefficient of nodes, as well as the Poisson distribution can better identify the assortative and disassortative structures in attributed networks. 6. Conclusion and discussion Integrating the linking relationships between nodes and the inherent attribute information of the nodes to mine the potential structure in network, and utilizing the attribute information to enhance the interpretability of the identified community, and then revealing the function of the network system is gradually being paid attention to. Based on the DPSB_PG model, the stochastic block model BCSBM that integrating betweenness centrality and clustering coefficient of nodes in attributed networks is proposed in this paper. The BCSBM model combines the network topology information and attribute information, and improves the accuracy of community detection by fitting the real network from the perspectives of node importance and node neighborhood. The uniform form of Poisson distribution facilitates the estimation of model parameters, and the EM algorithm is used to realize the parameters inference to ensure the convergence of the model. By comparing with the existing model on real attribute networks, it can be seen that BCSBM model can discover a variety of structures in networks, and the community detection accuracy is better than the DPSB_PG model, and the performance is improved in different extent compared with other existing related algorithms, which further illustrates the importance of betweenness centrality and clustering coefficient of nodes to improve the accuracy of community detection algorithm. Since the EM algorithm may require a large amount of computation and high time complexity in the process of parameters estimation depending on the network size, it affects the efficiency of the model. Therefore, in future work, other parameter estimation methods can be considered to improve the computational efficiency of the algorithm while ensuring the accuracy of community detection.Acknowledgment This work is supported by the National Natural Science Foundation of China [grant number 61976176]. Appendix A From Eq. (5), we know that the lower bound of the log-likelihood function is 𝐾���̅(𝐷, Θ, Φ) = 1 2 ∑ ∑ [𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� ln (𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑞𝑖𝑖��� 𝑟𝑟��� ) − 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟���] 𝑎��� 𝑟,𝑟���=1 𝑖��� 𝑖,𝑖���=1 + ∑ ∑ ∑ [𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 ln (𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝛾𝑖𝑖��� 𝑟 ) − 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖���] 𝑎��� 𝑟=1 𝐾 𝑖���=1 𝑖��� 𝑖=1 (5) Under 𝑎���𝑖𝑟 = 𝛾���𝑖𝑎���𝑖𝑟 and ∑ 𝑎���𝑖𝑟 = ∑ 𝛾���𝑖𝑎���𝑖𝑟 = 1 𝑖��� 𝑖=1 𝑖��� 𝑖=1 , we have 𝐾���̃(𝐷) = 1 2 ∑ ∑ [𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� ln (𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑞𝑖𝑖��� 𝑟𝑟��� ) − 𝑎���𝑖𝑟𝜃𝑟𝑟���𝑎���𝑖���𝑟���] 𝑎��� 𝑟,𝑟���=1 𝑖��� 𝑖,𝑖���=1 + ∑ ∑ ∑ [𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 ln (𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝛾𝑖𝑖��� 𝑟 ) − 𝑎���𝑖𝑟𝜙𝑟𝑖���] + ∑ 𝜁𝑟 𝑎��� 𝑟=1 𝑎��� 𝑟=1 𝐾 𝑖���=1 𝑖��� 𝑖=1 (1 − ∑ 𝑎���𝑖𝑟 𝑖��� 𝑖=1 ) (A1) Taking the partial derivative of 𝐾���̃(𝐷), we have 𝜕𝐾���̃(𝐷) 𝜕𝑎���𝑖𝑟 = 1 2 ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑎��� 𝑟���=1 𝑖��� 𝑖���=1 𝑎���𝑖𝑟 − 1 2 ∑ ∑ 𝜃𝑟𝑟���𝑎���𝑖���𝑟��� + ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑎���𝑖𝑟 𝑎��� 𝑟���=1 𝑖��� 𝑖���=1 − ∑ 𝜙𝑟𝑖��� − 𝜁𝑟 𝐾 𝑖���=1 = 1 2 ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑎��� 𝑟���=1 𝑖��� 𝑖���=1 𝑎���𝑖𝑟 − 1 2 ∑ 𝜃𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 + ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑎���𝑖𝑟 − 1 − 𝜁𝑟 (A2) Let 𝜕𝐾���̃(𝐷) 𝜕𝑎���𝑖𝑟 = 0, then 1 2 ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑎��� 𝑟���=1 𝑖��� 𝑖���=1 𝑎���𝑖𝑟 − 1 2 ∑ 𝜃𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 + ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑎���𝑖𝑟 − 1 − 𝜁𝑟 = 0 (A3) 1 2 ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑎��� 𝑟���=1 𝑖��� 𝑖,𝑖���=1 − 1 2 ∑ 𝜃𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 + ∑ ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑖��� 𝑖=1 − 1 − 𝜁𝑟 = 0 (A4) By Eq. (A3), Eq.(A4) and 𝑎���𝑖𝑟 = (𝑖���𝑖 + 𝑎���𝑖 + 𝑎���𝑖)𝑎���𝑖𝑟 , we have 𝑎���𝑖𝑟 in Eq. (8) as follows.𝑎���𝑖𝑟 = ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� + 2 × ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑎��� 𝑟���=1 𝑖��� 𝑖���=1 (𝑖���𝑖 + 𝑎���𝑖 + 𝑎���𝑖) × [∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� + 2 × ∑ ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑖��� 𝑖=1 𝑎��� 𝑟���=1 𝑖��� 𝑖,𝑖���=1 ] Note the constraint ∑ 𝜃𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 = 1, we have 𝐾���̃(Θ) = 1 2 ∑ ∑ [𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� ln (𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑞𝑖𝑖��� 𝑟𝑟��� ) − 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟���] 𝑎��� 𝑟,𝑟���=1 𝑖��� 𝑖,𝑖���=1 + ∑ ∑ ∑ [𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 ln (𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝛾𝑖𝑖��� 𝑟 ) − 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖���] + 𝜇 𝑎��� 𝑟=1 𝐾 𝑖���=1 𝑖��� 𝑖=1 (1 − ∑ 𝜃𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 ) (A5) Taking the partial derivative of 𝐾���̃(Θ), we have 𝜕𝐾���̃(Θ) 𝜕𝜃𝑟𝑟��� = 1 2 ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑖��� 𝑖,𝑖���=1 𝜃𝑟𝑟��� − 1 2 ∑ 𝛾���𝑖𝑎���𝑖𝑟𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑖��� 𝑖,𝑖���=1 − 𝜇 = 1 2 ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑖��� 𝑖,𝑖���=1 𝜃𝑟𝑟��� − 1 2 − 𝜇 (A6) Let 𝜕𝐾���̃(Θ) 𝜕𝜃𝑟𝑟��� = 0, then 1 2 ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑖��� 𝑖,𝑖���=1 𝜃𝑟𝑟��� − 1 2 − 𝜇 = 0 (A7) ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 𝑖��� 𝑖.𝑖���=1 − 1 − 2𝜇 = 0 (A8) By Eq. (A7) and Eq.(A8), we can derive the equation 𝜃𝑟𝑟��� in Eq. (9) as follows. 𝜃𝑟𝑟��� = ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑖��� 𝑖,𝑖���=1 ∑ ∑ 𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� 𝑎��� 𝑟,𝑟���=1 𝑖��� 𝑖,𝑖���=1 Similarly, for 𝜙𝑟𝑖���, we have 𝐾���̃(Φ) = 1 2 ∑ ∑ [𝑎𝑖𝑖���𝑞𝑖𝑖��� 𝑟𝑟��� ln (𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟��� 𝑞𝑖𝑖��� 𝑟𝑟��� ) − 𝛾���𝑖𝑎���𝑖𝑟𝜃𝑟𝑟���𝛾���𝑖���𝑎���𝑖���𝑟���] 𝑎��� 𝑟,𝑟���=1 𝑖��� 𝑖,𝑖���=1 + ∑ ∑ ∑ [𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 ln (𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖��� 𝛾𝑖𝑖��� 𝑟 ) − 𝛾���𝑖𝑎���𝑖𝑟𝜙𝑟𝑖���] + ∑ 𝜉𝑟 𝑎��� 𝑟=1 𝑎��� 𝑟=1 𝐾 𝑖���=1 𝑖��� 𝑖=1 (1 − ∑ 𝜙𝑟𝑖��� 𝐾 𝑖���=1 ) (A9)𝜕𝐾���̃(Φ) 𝜕𝜙𝑟𝑖��� = ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝑖��� 𝑖=1 𝜙𝑟𝑖��� − ∑ 𝛾���𝑖𝑎���𝑖𝑟 𝑖��� 𝑖=1 − 𝜉𝑟 = ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝑖��� 𝑖=1 𝜙𝑟𝑖��� − 1 − 𝜉𝑟 (A10) Let 𝜕𝐾���̃(Φ) 𝜕∅𝑟𝑖��� = 0, then ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝑖��� 𝑖=1 𝜙𝑟𝑖��� − 1 − 𝜉𝑟 = 0 (A11) ∑ ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑖��� 𝑖=1 − 1 − 𝜉𝑟 = 0 (A12) By Eq. (A11) and Eq.(A12), we have 𝜙𝑟𝑖��� in Eq. (9) in the following. 𝜙𝑟𝑖��� = ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝑖��� 𝑖=1 ∑ ∑ 𝑥𝑖𝑖���𝛾𝑖𝑖��� 𝑟 𝐾 𝑖���=1 𝑖��� 𝑖=1 References [1] Bothorel C, Cruz J D, Magnani M, et al. Clustering attributed graphs: models, measures and methods[J]. Network Science, 2015, 3(3): 408-444. [2] Khan K U, Nawaz W, Lee Y K. Set-based unified approach for summarization of a multi- attributed graph[J]. World Wide Web, 2017, 20: 543-570. [3] Wang Y, Li Y, Fan J, et al. A survey of typical attributed graph queries[J]. World Wide Web, 2021, 24: 297-346. [4] Zhou Y, Cheng H, Yu J X. Graph clustering based on structural/attribute similarities[J]. Proceedings of the VLDB Endowment, 2009, 2(1): 718-729. [5] Chen X, Peng H, Hu J. K-medoids substitution clustering method and a new clustering validity index method[C]. Sixth World Congress on Intelligent Control and Automation. IEEE, 2006, 2: 5896-5900. [6] Z. Wu, L. Zhao, S.-Y. Ho. Community Detection with Topological Structure and Attributesin Information Networks[J]. ACM Transactions on Intelligent Systems and Technology, 2017,8(2):1–17. [7] Alinezhad E, Teimourpour B, Sepehri M M, et al. Community detection in attributed networks considering both structural and attribute similarities: two mathematical programming approaches[J]. Neural Computing and Applications, 2020, 32: 3203-3220. [8] Falih I, Grozavu N, Kanawati R, et al. ANCA: Attributed network clustering algorithm[C]. International Conference on Complex Networks and their Applications. Springer, Cham, 2017: 241-252. [9] Berahmand K, Haghani S, Rostami M, et al. A new attributed graph clustering by using label propagation in complex networks[J]. Journal of King Saud University-Computer and Information Sciences, 2022, 34(5): 1869-1883. [10] Wang X, Jin D, Cao X, et al. Semantic community identification in large attribute networks[C].Proceedings of the AAAI Conference on Artificial Intelligence. 2016, 30(1). [11] Akoglu L, Tong H, Meeder B, et al. Pics: Parameter-free identification of cohesive subgroups in large attributed graphs[C]. Proceedings of the 2012 SIAM international conference on data mining. Society for Industrial and Applied Mathematics, 2012: 439-450. [12] Li Z, Pan Z, Hu G, et al. Detecting semantic communities in social networks[J]. IEICE TRANSACTIONS on Fundamentals of Electronics, Communications and Computer Sciences, 2017, 100(11): 2507-2512. [13] Huang J, Zhang T, Yu W, et al. Community Detection Based on Modularized Deep Nonnegative Matrix Factorization[J]. International Journal of Pattern Recognition and Artificial Intelligence, 2021, 35(2): 2159006. [14] Yang S, Yang B. Enhanced network embedding with text information[C].24th International Conference on Pattern Recognition (ICPR). IEEE, 2018: 326-331. [15] Newman M E J, Clauset A. Structure and inference in annotated networks[J]. Nature communications, 2016, 7(1): 11863. [16] Fortunato S, Hric D. Community detection in networks: A user guide[J]. Physics reports, 2016, 659: 1-44. [17] Liu X, Yang B, Song W, et al. A block-based generative model for attributed network embedding[J]. World Wide Web, 2021, 24: 1439-1464. [18] Holland P W, Laskey K B, Leinhardt S. Stochastic blockmodels: First steps[J]. Social Networks, 1983, 5(2): 109-137. [19] Chai B, Yu J, Jia C, et al. Combining a popularity-productivity stochastic block model with a discriminative-content model for general structure detection[J]. Physical review E, 2013, 88(1): 012807. [20] Shen H W, Cheng X Q, Guo J F. Exploring the structural regularities in networks[J]. Physical Review E, 2011, 84(5): 056111. [21] Yang T, Chi Y, Zhu S, et al. Directed network community detection: A popularity and productivity link model[C]. Proceedings of the 2010 SIAM international conference on data mining. Society for Industrial and Applied Mathematics, 2010: 742-753. [22] Chang Z, Jia C, Yin X, et al. A generative model for exploring structure regularities in attributed networks[J]. Information Sciences, 2019, 505: 252-264. [23] Chen Y, Wang X, Bu J, et al. Network structure exploration in networks with node attributes[J]. Physica A: Statistical Mechanics and its Applications, 2016, 449: 240-253. [24] Newman M E J, Leicht E A. Mixture models and exploratory analysis in networks[J]. Proceedings of the National Academy of Sciences, 2007, 104(23): 9564-9569. [25] He D, Feng Z, Jin D, et al. Joint identification of network communities and semantics via integrative modeling of network topologies and node contents[C]. Proceedings of the AAAI Conference on Artificial Intelligence. 2017, 31(1). [26] Karrer B, Newman M E J. Stochastic block models and community structure in networks[J]. Physical review E, 2011, 83(1): 016107. [27] Dempster A P, Laird N M, Rubin D B. Maximum likelihood from incomplete data via the EM algorithm[J]. Journal of the royal statistical society: series B (methodological), 1977, 39(1): 1- 22. [28] Decelle A, Krzakala F, Moore C, et al. Inference and phase transitions in the detection ofmodules in sparse networks[J]. Physical Review Letters, 2011, 107(6): 065701. [29] Chen H, Yu Z, Yang Q, et al. Attributed graph clustering with subspace stochastic block model[J]. Information Sciences, 2020, 535: 130-141. [30] Zheng Yimei, Jia Caiyan, Chang Zhenhai, Li Xuanya. A Degree Corrected Stochastic Block Model for Attributed Networks[J]. Journal of Computer Research and Development, 2020, 57(8): 1650-1662. doi: 10.7544/issn1000-1239.2020.20200158 [31] Zhou M, Han Q, Li M, et al. Nearest neighbor walk network embedding for link prediction in complex networks[J]. Physica A: Statistical Mechanics and its Applications, 2023, 620: 128757. [32] Wang Z Y, Han J T, Zhao J. Identifying node spreading influence for tunable clustering coefficient networks[J]. Physica A: Statistical Mechanics and its Applications, 2017, 486: 242- 250. [33] Xuan G, Shi Y Q, Chai P, et al. An enhanced EM algorithm using maximum entropy distribution as initial condition[C]. Proceedings of the 21st International Conference on Pattern Recognition (ICPR2012). IEEE, 2012: 849-852. [34] Sen P, Namata G, Bilgic M, et al. Collective classification in network data[J]. AI magazine, 2008, 29(3): 93-93. [35] Rostami M, Oussalah M. A novel attributed community detection by integration of feature weighting and node centrality[J]. Online Social Networks and Media, 2022, 30: 100219. [36] Namata G, London B, Getoor L, et al. Query-driven active surveying for collective classification[C].10th international workshop on mining and learning with graphs. 2012, 8: 1. [37] Danon L, Diaz-Guilera A, Duch J, et al. Comparing community structure identification[J]. Journal of statistical mechanics: Theory and experiment, 2005(09): P09008. [38] Yang T, Jin R, Chi Y, et al. Combining link and content for community detection: a discriminative approach[C]. Proceedings of the 15th ACM SIGKDD international conference on Knowledge discovery and data mining. 2009: 927-936. [39] Liu W, Chang Z, Jia C, et al. A generative node-attribute network model for detecting generalized structure and semantics[J]. Physica A: Statistical Mechanics and its Applications, 2022, 588: 126557.